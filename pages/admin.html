<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#1a2980">
  <title>Admin</title>
  <link rel="stylesheet" href="../css/styles.css">
  <link rel="manifest" href="../assets/manifest.json">
</head>

<body>

  <header class="app-header">
    <div class="user-info">
      <h3>Panel Admin</h3>
    </div>
    <button class="btn btn-outline btn-logout" onclick="logout()">Salir</button>
  </header>

  <main class="main-content">
    <div class="container">

      <div class="section-header">
        <div class="section-header-content">
          <div class="section-title-main">Gesti√≥n</div>
        </div>
        <button class="btn btn-primary" onclick="descargarPDF()" style="margin-top: 1rem;">Descargar PDF</button>
      </div>

      <div class="card">
        <div class="card-header">
          <div class="card-title">Solicitudes Recientes</div>
        </div>
        <ul id="lista" class="list-group" style="list-style: none; padding: 0;"></ul>
      </div>

      <div class="card">
        <div class="card-header">
          <div class="card-title">Crear Nuevo Usuario</div>
        </div>
        <div class="card-body">
          <div class="form-group">
            <input id="u" placeholder="Usuario">
          </div>
          <div class="form-group">
            <input id="p" placeholder="Password" type="password">
          </div>
          <div class="form-group">
            <input id="n" placeholder="Nombre Completo">
          </div>
          <div class="form-group">
            <select id="r"
              style="width: 100%; padding: 0.875rem; border-radius: 0.75rem; border: 2px solid var(--bg-gray);">
              <option value="cliente">Cliente</option>
              <option value="admin">Admin</option>
            </select>
          </div>
          <button class="btn btn-primary" onclick="crearUser()">Crear Usuario</button>
        </div>
      </div>

    </div>
  </main>

  <script src="../app.js"></script>
  <script>
    checkAuth("admin");

    async function cargar() {
      const data = await obtenerTodasLasSolicitudes();
      const ul = document.getElementById("lista");
      ul.innerHTML = "";
      data.forEach(s => {
        ul.innerHTML += `
        <li>
            ${s.motivo} - ${s.estado}
            <button onclick="actualizarEstadoSolicitud(${s.id}, 'aprobado')">Aprobar</button>
            <button onclick="actualizarEstadoSolicitud(${s.id}, 'rechazado')">Rechazar</button>
        </li>`;
      });
    }

    async function crearUser() {
      await crearUsuario(
        document.getElementById("u").value,
        document.getElementById("p").value,
        document.getElementById("n").value,
        document.getElementById("r").value
      );
    }

    cargar();
  </script>

</body>

</html>