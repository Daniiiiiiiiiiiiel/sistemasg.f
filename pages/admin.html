<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#1a2980">
  <title>Admin</title>
  <link rel="manifest" href="../assets/manifest.json">
</head>

<body>

  <h2>Panel Admin</h2>

  <button onclick="logout()">Cerrar sesi√≥n</button>
  <button onclick="descargarPDF()">Descargar PDF</button>

  <hr>

  <h3>Solicitudes</h3>
  <ul id="lista"></ul>

  <hr>

  <h3>Crear usuario</h3>

  <input id="u" placeholder="Usuario">
  <br>
  <input id="p" placeholder="Password">
  <br>
  <input id="n" placeholder="Nombre">
  <br>
  <select id="r">
    <option value="cliente">Cliente</option>
    <option value="admin">Admin</option>
  </select>
  <br><br>

  <button onclick="crearUser()">Crear</button>

  <script src="../app.js"></script>
  <script>
    checkAuth("admin");

    async function cargar() {
      const data = await obtenerTodasLasSolicitudes();
      const ul = document.getElementById("lista");
      ul.innerHTML = "";
      data.forEach(s => {
        ul.innerHTML += `
        <li>
            ${s.motivo} - ${s.estado}
            <button onclick="actualizarEstadoSolicitud(${s.id}, 'aprobado')">Aprobar</button>
            <button onclick="actualizarEstadoSolicitud(${s.id}, 'rechazado')">Rechazar</button>
        </li>`;
      });
    }

    async function crearUser() {
      await crearUsuario(
        document.getElementById("u").value,
        document.getElementById("p").value,
        document.getElementById("n").value,
        document.getElementById("r").value
      );
    }

    cargar();
  </script>

</body>

</html>